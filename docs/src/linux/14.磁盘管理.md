在 Linux 系统中，磁盘管理涉及磁盘分区、格式化、挂载、查看使用情况等操作，以下是常用的磁盘管理命令和操作方法：

## 一、查看磁盘信息

### 1. 查看磁盘分区情况

```bash
fdisk -l  # 列出所有磁盘及分区信息（需root权限）
# 输出示例：/dev/sda 是第一块硬盘，/dev/sda1 是其第一个分区
```

### 2. 查看磁盘使用情况

```bash
df -h  # 以m/g单位显示所有挂载点的磁盘使用情况
df -i  # 查看inode使用情况（避免因inode耗尽导致无法创建文件）
```

### 3. 查看目录 / 文件占用空间

```bash
du -sh 目录名  # 显示目录总大小（-s：汇总，-h：友好单位）
du -h --max-depth=1  # 显示当前目录下一级子目录的大小
du -ah  # 显示所有文件和目录的大小（-a：包括文件）
```

## 二、磁盘分区（`fdisk`/`parted`）

### 1. `fdisk`（适用于 MBR 分区表，支持小于 2TB 的磁盘）

```bash
fdisk /dev/sdX  # 对磁盘sdX进行分区操作（X为a、b等）
# 交互命令：
# n：新建分区
# p：显示分区表
# d：删除分区
# w：保存退出
# q：不保存退出
```

### 2. `parted`（适用于 GPT 分区表，支持大于 2TB 的磁盘）

```bash
parted /dev/sdX  # 进入parted交互模式
# 常用命令：
# mklabel gpt：创建GPT分区表
# mkpart：创建分区
# print：显示分区信息
# quit：退出
```

## 三、格式化分区（创建文件系统）

分区后需格式化才能使用，常见文件系统有 `ext4`、`xfs`、`fat32` 等：

```bash
# 格式化为ext4文件系统（Linux常用）
mkfs.ext4 /dev/sdX1  # sdX1为分区名

# 格式化为xfs文件系统（CentOS默认）
mkfs.xfs /dev/sdX1

# 格式化为fat32（跨平台兼容，如U盘）
mkfs.vfat -F 32 /dev/sdX1
```

## 四、挂载与卸载分区

### 1. 临时挂载（重启后失效）

```bash
# 创建挂载点目录
mkdir /mnt/mydisk

# 挂载分区到目录
mount /dev/sdX1 /mnt/mydisk

# 挂载ISO镜像文件
mount -o loop /path/to/image.iso /mnt/iso
```

### 2. 永久挂载（写入`/etc/fstab`）

```bash
# 查看分区UUID（推荐使用UUID挂载，避免设备名变动）
blkid /dev/sdX1  # 输出示例：UUID="xxxx-xxxx" TYPE="ext4"

# 编辑fstab文件
sudo vim /etc/fstab

# 添加一行（格式：UUID=... 挂载点 文件系统 选项 0 0）
UUID=xxxx-xxxx /mnt/mydisk ext4 defaults 0 0

# 使配置生效（无需重启）
mount -a
```

### 3. 卸载分区

```bash
umount /mnt/mydisk  # 通过挂载点卸载
umount /dev/sdX1    # 通过设备名卸载
```

## 五、swap 分区管理

swap 分区是系统的虚拟内存，当物理内存不足时使用：

### 1. 创建 swap 分区

```bash
# 格式化分区为swap
mkswap /dev/sdX2

# 启用swap分区
swapon /dev/sdX2

# 永久启用（添加到/etc/fstab）
UUID=xxxx-xxxx none swap defaults 0 0
```

### 2. 查看 swap 使用情况

```bash
free -h  # 查看swap总大小和使用情况
swapon --show  # 显示已启用的swap设备
```

## 六、磁盘检查与修复

```bash
# 检查ext4文件系统（卸载状态下）
e2fsck -f /dev/sdX1  # -f：强制检查

# 检查xfs文件系统（挂载状态下）
xfs_repair -n /dev/sdX1  # -n：只检查不修复
```

## 注意事项

1. 分区和格式化操作会删除数据，务必提前备份
2. 挂载点目录必须存在，建议创建空目录作为挂载点
3. 修改 `/etc/fstab` 时格式错误可能导致系统无法启动，建议先备份该文件
4. 对于大容量磁盘（>2TB），推荐使用 GPT 分区表（`parted`工具）

磁盘管理是系统维护的重要部分，合理规划分区和监控磁盘使用情况可以保障系统稳定运行。