<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">在 Linux 系统中，</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">服务（Service）</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> 是在后台运行、独立于用户交互的长期进程，负责执行核心系统功能（如网络管理、定时任务）或应用程序功能（如 Web 服务、数据库服务）。Linux 服务的管理机制随系统发展不断演进，目前主流的两种管理架构是 </font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">Systemd</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（现代系统默认，如 CentOS 7+、Ubuntu 15.04+、Debian 8+）和 </font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">SysVinit</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（传统架构，多见于旧系统如 CentOS 6、Ubuntu 14.04）。</font>

## <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">一、核心概念：服务与进程的关系</font>
<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">服务本质是 “被管理的进程”，其核心特征包括：</font>

+ **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">后台运行</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">：无交互式界面，通过终端命令或配置文件控制。</font>
+ **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">开机自启</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">：可配置为系统启动时自动加载，无需手动启动。</font>
+ **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">状态可控</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">：支持启动（start）、停止（stop）、重启（restart）、重载配置（reload）等操作。</font>
+ **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">依赖管理</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">：现代服务管理器（如 Systemd）可自动处理服务间的依赖（如 “数据库服务启动后，再启动 Web 服务”）。</font>

## <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">二、主流服务管理架构：Systemd（现代 Linux 默认）</font>
`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">Systemd</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">是目前绝大多数 Linux 发行版的默认初始化系统（Init System），取代了传统的 SysVinit，具有</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">并行启动、依赖管理、日志集成</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">等优势。其核心是通过 “单元（Unit）” 管理服务、设备、挂载点等，其中服务对应的单元类型为</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">.service</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">。</font>

### <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">1. Systemd 服务的核心命令</font>
<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">所有操作需通过</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">systemctl</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">工具执行，部分命令需</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">权限（管理系统级服务）。</font>

| **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">命令作用</font>** | **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">完整命令</font>** | **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">启动服务</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl start [服务名]</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">临时启动服务，重启后失效（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl start nginx</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">停止服务</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl stop [服务名]</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">临时停止服务，重启后失效（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl stop nginx</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">重启服务</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl restart [服务名]</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">停止后重新启动，适用于配置修改后（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl restart mysql</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">重载配置（不中断服务）</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl reload [服务名]</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">仅重载配置文件，服务不中断（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl reload nginx</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看服务状态</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">systemctl status [服务名]</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">显示服务是否运行、PID、日志片段等（最常用的排障命令）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">设置开机自启</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl enable [服务名]</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">永久配置：系统启动时自动启动服务（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl enable sshd</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">关闭开机自启</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl disable [服务名]</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">永久取消：系统启动时不自动启动服务。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看是否开机自启</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">systemctl is-enabled [服务名]</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">返回</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">enabled</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（已启用）、</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">disabled</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（已禁用）等状态。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看所有已启动的服务</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">systemctl list-units --type=service</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">列出当前活跃的服务单元。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看所有服务（含未启动）</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">systemctl list-units --type=service --all</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">列出所有服务单元（包括未激活的）。</font> |


### <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">2. Systemd 服务的配置文件</font>
<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">服务的行为由配置文件定义，默认路径为：</font>

+ **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">系统级服务</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/usr/lib/systemd/system/</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（软件安装时自动生成）</font>
+ **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">用户自定义服务</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/etc/systemd/system/</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（用户手动创建，优先级高于系统级）</font>

<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">配置文件命名格式为</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">[服务名].service</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">nginx.service</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">），核心结构如下（以 Nginx 为例）：</font>

**<font style="color:rgba(0, 0, 0, 0.85);background-color:rgb(252, 252, 252);">ini</font>**

```plain
[Unit]
Description=Nginx HTTP Server  # 服务描述
After=network.target remote-fs.target nss-lookup.target  # 启动依赖：网络、远程文件系统等就绪后再启动
Wants=network.target  # 弱依赖：依赖服务未启动也不影响当前服务启动（强依赖用Requires）

[Service]
Type=forking  # 进程类型：forking（后台运行，父进程退出）、simple（前台运行）等
PIDFile=/var/run/nginx.pid  # PID文件路径（Type=forking时需指定）
ExecStart=/usr/sbin/nginx -c /etc/nginx/nginx.conf  # 启动命令
ExecReload=/bin/kill -s HUP $MAINPID  # 重载配置命令（通过HUP信号通知主进程）
ExecStop=/bin/kill -s QUIT $MAINPID  # 停止命令（通过QUIT信号优雅停止）
PrivateTmp=true  # 为服务分配独立的临时目录（安全优化）

[Install]
WantedBy=multi-user.target  # 开机自启的目标级别：多用户模式（无图形界面）
```

<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">修改配置文件后，需执行</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl daemon-reload</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">让 Systemd 加载新配置，再重启服务生效。</font>

### <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">3. Systemd 服务的日志查看</font>
<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">Systemd 集成了日志系统</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">journald</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">，可通过</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">journalctl</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看服务日志（无需单独配置 rsyslog）：</font>

+ <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看指定服务的实时日志：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo journalctl -u [服务名] -f</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">-f</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">表示 “跟踪日志”，类似</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">tail -f</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）</font>
+ <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看指定服务的历史日志：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo journalctl -u [服务名]</font>`
+ <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看最近 10 行日志：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo journalctl -u [服务名] -n 10</font>`
+ <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">按时间筛选日志：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo journalctl -u [服务名] --since "2024-01-01 00:00" --until "2024-01-01 12:00"</font>`

## <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">三、传统服务管理架构：SysVinit（旧系统兼容）</font>
<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">SysVinit 是早期 Linux 的服务管理架构，依赖 “运行级别（Runlevel）” 和 “启动脚本”，目前仅在旧系统（如 CentOS 6、Ubuntu 14.04）中使用。</font>

### <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">1. SysVinit 的核心概念：运行级别（Runlevel）</font>
<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">运行级别定义系统的启动状态，不同级别加载不同服务，常见级别如下：</font>

| **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">运行级别</font>** | **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">含义（CentOS/RHEL）</font>** | **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">含义（Ubuntu/Debian）</font>** |
| :--- | :--- | :--- |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">0</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">关机（halt）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">关机</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">1</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">单用户模式（救援模式）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">单用户模式</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">2</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">多用户模式（无网络）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">多用户模式（带网络）</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">3</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">多用户模式（带网络，无图形）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">同级别 2</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">4</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">未使用（自定义）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">未使用</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">5</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">图形界面模式</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">图形界面模式</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">6</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">重启（reboot）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">重启</font> |


<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看当前运行级别：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">runlevel</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">切换运行级别：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">init [级别]</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">init 0</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">关机，</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">init 3</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">切换到无图形模式）</font>

### <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">2. SysVinit 服务的核心命令</font>
<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">通过</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">service</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">工具管理服务，通过</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">chkconfig</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">工具配置开机自启：</font>

| **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">命令作用</font>** | **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">完整命令</font>** | **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">启动服务</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo service [服务名] start</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo service httpd start</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（httpd 是 Apache 服务名）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">停止服务</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo service [服务名] stop</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo service mysqld stop</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（mysqld 是 MySQL 服务名）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">重启服务</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo service [服务名] restart</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo service sshd restart</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看服务状态</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo service [服务名] status</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">显示服务是否运行、PID 等。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">设置开机自启</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo chkconfig [服务名] on</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo chkconfig httpd on</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（所有运行级别均自启）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">关闭开机自启</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo chkconfig [服务名] off</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo chkconfig mysqld off</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看服务自启状态</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">chkconfig --list [服务名]</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">显示服务在各运行级别的自启状态（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">chkconfig --list httpd</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）。</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看所有服务自启状态</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">chkconfig --list</font>` | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">列出所有服务在各运行级别的自启状态。</font> |


### <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">3. SysVinit 服务的启动脚本</font>
<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">SysVinit 通过 Shell 脚本管理服务，脚本默认路径为</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/etc/init.d/</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（部分系统链接到</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/etc/rc.d/init.d/</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">），脚本名即服务名（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">httpd</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">、</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">mysqld</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）。</font>

<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">启动脚本的核心逻辑是接收</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">start</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">、</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">stop</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">、</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">restart</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">等参数，执行对应的命令。例如，</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/etc/init.d/httpd</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">的简化逻辑：</font>

**<font style="color:rgba(0, 0, 0, 0.85);background-color:rgb(252, 252, 252);">bash</font>**

```bash
#!/bin/bash
case "$1" in
    start)
        echo "Starting httpd..."
        /usr/sbin/httpd  # 启动Apache
        ;;
    stop)
        echo "Stopping httpd..."
        killall httpd     # 停止Apache
        ;;
    restart)
        $0 stop
        $0 start
        ;;
    status)
        if pgrep httpd > /dev/null; then
            echo "httpd is running"
        else
            echo "httpd is stopped"
        fi
        ;;
    *)
        echo "Usage: $0 {start|stop|restart|status}"
        exit 1
        ;;
esac
```

## <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">四、常见服务示例与管理场景</font>
### <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">1. 示例 1：管理 SSH 服务（远程登录）</font>
+ **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">Systemd 系统</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">：</font>
    - <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">启动：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl start sshd</font>`
    - <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">开机自启：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo systemctl enable sshd</font>`
    - <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看状态：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">systemctl status sshd</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（确认是否监听 22 端口）</font>
+ **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">SysVinit 系统</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">：</font>
    - <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">启动：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo service sshd start</font>`
    - <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">开机自启：</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">sudo chkconfig sshd on</font>`

### <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">2. 示例 2：管理 Nginx 服务（Web 服务器）</font>
+ <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">修改 Nginx 配置文件后，重载配置（不中断服务）：</font>**<font style="color:rgba(0, 0, 0, 0.85);background-color:rgb(252, 252, 252);">bash</font>**

```bash
sudo systemctl reload nginx  # Systemd
sudo service nginx reload    # SysVinit
```

+ <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看 Nginx 日志（Systemd）：</font>**<font style="color:rgba(0, 0, 0, 0.85);background-color:rgb(252, 252, 252);">bash</font>**

```bash
sudo journalctl -u nginx -f  # 实时跟踪日志
```

### <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">3. 示例 3：自定义 Systemd 服务（以 Python 脚本为例）</font>
<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">假设需要将一个 Python 脚本（</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/opt/my_script.py</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）作为服务后台运行，步骤如下：</font>

1. <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">创建服务配置文件</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/etc/systemd/system/my_script.service</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">：</font>**<font style="color:rgba(0, 0, 0, 0.85);background-color:rgb(252, 252, 252);">ini</font>**

```plain
[Unit]
Description=My Custom Python Script
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/python3 /opt/my_script.py  # Python路径+脚本路径
Restart=always  # 服务意外退出时自动重启（故障自愈）
User=www-data  # 以低权限用户运行（安全优化）

[Install]
WantedBy=multi-user.target
```

2. <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">加载配置并启动服务：</font>**<font style="color:rgba(0, 0, 0, 0.85);background-color:rgb(252, 252, 252);">bash</font>**

```bash
sudo systemctl daemon-reload  # 加载新配置
sudo systemctl start my_script  # 启动服务
sudo systemctl enable my_script  # 设置开机自启
systemctl status my_script  # 验证状态
```

## <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">五、关键区别：Systemd vs SysVinit</font>
| **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">对比维度</font>** | **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">Systemd</font>** | **<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">SysVinit</font>** |
| :--- | :--- | :--- |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">核心工具</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">systemctl</font>` | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">service</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">+</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">chkconfig</font>` |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">服务配置文件</font> | `<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">.service</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">单元文件（INI 格式）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">Shell 脚本（</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/etc/init.d/</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">启动方式</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">并行启动（快）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">串行启动（慢）</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">依赖管理</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">支持强依赖（Requires）、弱依赖（Wants）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">依赖需手动在脚本中定义（复杂）</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">日志集成</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">内置</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">journald</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">journalctl</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">依赖</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">rsyslog</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">（日志存</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/var/log/</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）</font> |
| <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">运行级别</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">目标（Target）替代（如</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">multi-user.target</font>`<br/><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">）</font> | <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">数字级别（0-6）</font> |


## <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">六、总结</font>
+ <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">现代 Linux 系统（CentOS 7+、Ubuntu 15.04+）优先使用</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">Systemd</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">，核心命令是</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">systemctl</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">，配置文件为</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">.service</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">单元文件，日志通过</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">journalctl</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">查看。</font>
+ <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">旧系统（CentOS 6、Ubuntu 14.04）使用</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">SysVinit</font>**<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">，核心命令是</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">service</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">和</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">chkconfig</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">，配置依赖</font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">/etc/init.d/</font>`<font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);"> </font><font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">下的 Shell 脚本。</font>
+ <font style="color:rgb(0, 0, 0);background-color:rgb(252, 252, 252);">管理服务的核心场景：启动 / 停止 / 重启、配置开机自启、查看状态与日志、处理依赖关系。掌握这些基础操作，即可应对 Linux 服务的日常运维需求。</font>

